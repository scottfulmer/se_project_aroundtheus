(()=>{"use strict";const e=class{constructor(e,t){this._settings=e,this._inputSelector=e.inputSelector,this._submitButton=e.submitButton,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput(this._inputElements)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButton),this._toggleButtonState(this._inputElements,this._submitButton,this._inputSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState(this._inputElements,this._submitButton,this._inputSelector)}))}))}resetValidation(){this._toggleButtonState()}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};function t(e){e.classList.add("modal_opened"),document.addEventListener("keyup",r),e.addEventListener("mousedown",i)}function n(e){e.classList.remove("modal_opened"),document.removeEventListener("keyup",r),e.removeEventListener("mousedown",i)}function r(e){"Escape"===e.key&&n(document.querySelector(".modal_opened"))}function i(e){e.target===e.currentTarget&&n(e.target)}const o=document.querySelector("#preview-image-modal"),s=document.querySelector(".modal__preview-image"),a=document.querySelector(".modal__footer");document.querySelector(".card__image");const l=document.querySelector("#add-card-modal"),c=document.querySelector("#profile-edit-button"),u=l.querySelector("#card__close-modal"),d=document.querySelector(".profile__add-button"),_=document.querySelector(".profile__title"),m=document.querySelector(".profile__description"),p=document.querySelector("#profile-title-input"),h=document.querySelector("#profile-description-input"),v=document.querySelector("#preview-image-modal"),y=(document.querySelector(".modal__preview-image"),document.querySelector(".modal__footer"),document.querySelector("#preview-close-button")),S=document.querySelector("#profile-edit-modal"),g=S.querySelector("#profile-edit-close"),q=S.querySelector(".modal__form"),f=l.querySelector("#add-card-form"),E=document.querySelector(".cards__list"),L=(document.querySelector("#card-template").content.firstElementChild,f.querySelector(".modal__input-type-title")),w=f.querySelector(".modal__input-type-url");function k(){n(S)}const b=(e,n)=>{const r=new class{constructor(e,t){this._name=e.name,this._link=e.link,this._cardSelector=t}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLikeIcon())),this._element.querySelector(".card__delete-button").addEventListener("click",this._handleDeleteCard),this._element.querySelector(".card__image").addEventListener("click",this._handlePreviewPicture)}_handleLikeIcon(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteCard=()=>{this._element.remove(),this._element=null};_handlePreviewPicture=()=>{s.src=this._link,a.textContent=this._name,s.alt=this._name,t(o)};getView(){return this._element=this._getTemplate(),this._element.querySelector(".card__title").textContent=this._name,this._element.querySelector(".card__image").src=this._link,this._element.querySelector(".card__image").alt=this._alt,this._setEventListeners(),this._element}}(e,"#card-template");n.prepend(r.getView())},C={inputSelector:".modal__form-input",submitButton:".modal__button",inactiveButtonClass:"modal__button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},B=new e(C,q),j=new e(C,f);B.enableValidation(),j.enableValidation(),c.addEventListener("click",(()=>{p.value=_.textContent,h.value=m.textContent,t(S)})),f.addEventListener("submit",(function(e){e.preventDefault();const t=L.value,r=w.value;f.querySelector(".modal__button"),b({name:t,link:r},E),L.value="",w.value="",j.resetValidation(),n(l)})),d.addEventListener("click",(()=>t(l))),u.addEventListener("click",(()=>n(l))),g.addEventListener("click",k),q.addEventListener("submit",(function(e){e.preventDefault(),_.textContent=p.value,m.textContent=h.value,k()})),y.addEventListener("click",(()=>n(v))),[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}].forEach((e=>b(e,E)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLm1haW4uanMiLCJtYXBwaW5ncyI6Im1CQXNGQSxRQXRGQSxNQUNFQSxZQUFZQyxFQUFVQyxHQUNwQkMsS0FBS0MsVUFBWUgsRUFDakJFLEtBQUtFLGVBQWlCSixFQUFTSyxjQUMvQkgsS0FBS0ksY0FBZ0JOLEVBQVNPLGFBQzlCTCxLQUFLTSxxQkFBdUJSLEVBQVNTLG9CQUNyQ1AsS0FBS1EsaUJBQW1CVixFQUFTVyxnQkFDakNULEtBQUtVLFlBQWNaLEVBQVNhLFdBQzVCWCxLQUFLWSxNQUFRYixDQUNmLENBRUFjLGdCQUFnQkMsR0FDZCxNQUFNQyxFQUFzQmYsS0FBS1ksTUFBTUksY0FDckMsSUFBSUYsRUFBYUcsWUFFbkJILEVBQWFJLFVBQVVDLElBQUluQixLQUFLUSxrQkFDaENPLEVBQW9CSyxZQUFjTixFQUFhTyxrQkFDL0NOLEVBQW9CRyxVQUFVQyxJQUFJbkIsS0FBS1UsWUFDekMsQ0FFQVksZ0JBQWdCUixHQUNkLE1BQU1DLEVBQXNCZixLQUFLWSxNQUFNSSxjQUNyQyxJQUFJRixFQUFhRyxZQUVuQkgsRUFBYUksVUFBVUssT0FBT3ZCLEtBQUtRLGtCQUNuQ08sRUFBb0JLLFlBQWMsR0FDbENMLEVBQW9CRyxVQUFVSyxPQUFPdkIsS0FBS1UsWUFDNUMsQ0FFQWMscUJBQ014QixLQUFLeUIsaUJBQWlCekIsS0FBSzBCLGlCQUM3QjFCLEtBQUtJLGNBQWNjLFVBQVVDLElBQUluQixLQUFLTSxzQkFDdENOLEtBQUtJLGNBQWN1QixVQUFXLElBRTlCM0IsS0FBS0ksY0FBY2MsVUFBVUssT0FBT3ZCLEtBQUtNLHNCQUN6Q04sS0FBS0ksY0FBY3VCLFVBQVcsRUFFbEMsQ0FDQUYsaUJBQWlCRyxHQUNmLE9BQU9BLEVBQVVDLE1BQU1mLElBQ2JBLEVBQWFnQixTQUFTQyxPQUVsQyxDQUVBQyxvQkFBb0JsQixHQUNiQSxFQUFhZ0IsU0FBU0MsTUFHekIvQixLQUFLc0IsZ0JBQWdCUixHQUZyQmQsS0FBS2EsZ0JBQWdCQyxFQUl6QixDQUVBbUIscUJBQ0VqQyxLQUFLMEIsZUFBaUIsSUFBSTFCLEtBQUtZLE1BQU1zQixpQkFBaUJsQyxLQUFLRSxpQkFDM0RGLEtBQUtJLGNBQWdCSixLQUFLWSxNQUFNSSxjQUFjaEIsS0FBS0ksZUFDbkRKLEtBQUt3QixtQkFDSHhCLEtBQUswQixlQUNMMUIsS0FBS0ksY0FDTEosS0FBS0UsZ0JBR1BGLEtBQUswQixlQUFlUyxTQUFTckIsSUFDM0JBLEVBQWFzQixpQkFBaUIsU0FBVUMsSUFDdENyQyxLQUFLZ0Msb0JBQW9CbEIsR0FFekJkLEtBQUt3QixtQkFDSHhCLEtBQUswQixlQUNMMUIsS0FBS0ksY0FDTEosS0FBS0UsZUFDTixHQUNELEdBRU4sQ0FFQW9DLGtCQUNFdEMsS0FBS3dCLG9CQUNQLENBRUFlLG1CQUNFdkMsS0FBS1ksTUFBTXdCLGlCQUFpQixVQUFXQyxJQUNyQ0EsRUFBRUcsZ0JBQWdCLElBRXBCeEMsS0FBS2lDLG9CQUNQLEdDbkZLLFNBQVMsRUFBVVEsR0FDeEJBLEVBQU12QixVQUFVQyxJQUFJLGdCQUNwQnVCLFNBQVNOLGlCQUFpQixRQUFTTyxHQUVuQ0YsRUFBTUwsaUJBQWlCLFlBQWFRLEVBQ3RDLENBQ08sU0FBUyxFQUFXSCxHQUN6QkEsRUFBTXZCLFVBQVVLLE9BQU8sZ0JBQ3ZCbUIsU0FBU0csb0JBQW9CLFFBQVNGLEdBRXRDRixFQUFNSSxvQkFBb0IsWUFBYUQsRUFDekMsQ0FDQSxTQUFTRCxFQUFlTixHQUNSLFdBQVZBLEVBQUVTLEtBRUosRUFEb0JKLFNBQVMxQixjQUFjLGlCQUcvQyxDQUVBLFNBQVM0QixFQUF3QkcsR0FDM0JBLEVBQUlDLFNBQVdELEVBQUlFLGVBQ3JCLEVBQVdGLEVBQUlDLE9BRW5CLENDdkJBLE1BQU1FLEVBQWVSLFNBQVMxQixjQUFjLHdCQUN0Q21DLEVBQW9CVCxTQUFTMUIsY0FBYyx5QkFDM0NvQyxFQUFxQlYsU0FBUzFCLGNBQWMsa0JBQzlCMEIsU0FBUzFCLGNBQWMsZ0JBNkQzQyxNQy9CTXFDLEVBQWVYLFNBQVMxQixjQUFjLG1CQUV0Q3NDLEVBQW9CWixTQUFTMUIsY0FBYyx3QkFDM0N1QyxFQUNKRixFQUFhckMsY0FBYyxzQkFDdkJ3QyxFQUFtQmQsU0FBUzFCLGNBQWMsd0JBSTFDeUMsRUFBZWYsU0FBUzFCLGNBQWMsbUJBQ3RDMEMsRUFBcUJoQixTQUFTMUIsY0FBYyx5QkFDNUMyQyxFQUFvQmpCLFNBQVMxQixjQUFjLHdCQUMzQzRDLEVBQTBCbEIsU0FBUzFCLGNBQ3ZDLDhCQU1JLEVBQWUwQixTQUFTMUIsY0FBYyx3QkFHdEM2QyxHQUZvQm5CLFNBQVMxQixjQUFjLHlCQUN0QjBCLFNBQVMxQixjQUFjLGtCQUNyQjBCLFNBQVMxQixjQUFjLDBCQUk5QzhDLEVBQW1CcEIsU0FBUzFCLGNBQWMsdUJBQzFDK0MsRUFBbUJELEVBQWlCOUMsY0FBYyx1QkFDbERnRCxFQUFrQkYsRUFBaUI5QyxjQUFjLGdCQUNqRGlELEVBQXFCWixFQUFhckMsY0FBYyxrQkFFaERrRCxFQUFheEIsU0FBUzFCLGNBQWMsZ0JBSXBDbUQsR0FGSnpCLFNBQVMxQixjQUFjLGtCQUFrQm9ELFFBQVFDLGtCQUU1QkosRUFBbUJqRCxjQUN4Qyw2QkFFSXNELEVBQWVMLEVBQW1CakQsY0FBYywwQkFRdEQsU0FBU3VELElBQ1AsRUFBV1QsRUFDYixDQTRCQSxNQUFNVSxFQUFhLENBQUNDLEVBQVVDLEtBQzVCLE1BQU1DLEVBQU8sSUR2R2YsTUFDRTlFLFlBQVk0RSxFQUFVRyxHQUNwQjVFLEtBQUs2RSxNQUFRSixFQUFTSyxLQUN0QjlFLEtBQUsrRSxNQUFRTixFQUFTTyxLQUV0QmhGLEtBQUtpRixjQUFnQkwsQ0FDdkIsQ0FFQU0sZUFDRSxPQUFPeEMsU0FDSjFCLGNBQWNoQixLQUFLaUYsZUFDbkJiLFFBQVFwRCxjQUFjLFNBQ3RCbUUsV0FBVSxFQUNmLENBRUFsRCxxQkFDRWpDLEtBQUtvRixTQUNGcEUsY0FBYyxzQkFDZG9CLGlCQUFpQixTQUFTLElBQU1wQyxLQUFLcUYsb0JBRXhDckYsS0FBS29GLFNBQ0ZwRSxjQUFjLHdCQUNkb0IsaUJBQWlCLFFBQVNwQyxLQUFLc0YsbUJBRWxDdEYsS0FBS29GLFNBQ0ZwRSxjQUFjLGdCQUNkb0IsaUJBQWlCLFFBQVNwQyxLQUFLdUYsc0JBQ3BDLENBQ0FGLGtCQUNFckYsS0FBS29GLFNBQ0ZwRSxjQUFjLHNCQUNkRSxVQUFVc0UsT0FBTywyQkFDdEIsQ0FDQUYsa0JBQW9CLEtBQ2xCdEYsS0FBS29GLFNBQVM3RCxTQUNkdkIsS0FBS29GLFNBQVcsSUFBSSxFQUd0Qkcsc0JBQXdCLEtBQ3RCcEMsRUFBa0JzQyxJQUFNekYsS0FBSytFLE1BQzdCM0IsRUFBbUJoQyxZQUFjcEIsS0FBSzZFLE1BQ3RDMUIsRUFBa0J1QyxJQUFNMUYsS0FBSzZFLE1BRTdCLEVBQVUzQixFQUFhLEVBR3pCeUMsVUFPRSxPQU5BM0YsS0FBS29GLFNBQVdwRixLQUFLa0YsZUFDckJsRixLQUFLb0YsU0FBU3BFLGNBQWMsZ0JBQWdCSSxZQUFjcEIsS0FBSzZFLE1BQy9EN0UsS0FBS29GLFNBQVNwRSxjQUFjLGdCQUFnQnlFLElBQU16RixLQUFLK0UsTUFDdkQvRSxLQUFLb0YsU0FBU3BFLGNBQWMsZ0JBQWdCMEUsSUFBTTFGLEtBQUs0RixLQUN2RDVGLEtBQUtpQyxxQkFFRWpDLEtBQUtvRixRQUNkLEdDaURzQlgsRUFyQ0gsa0JBc0NuQkMsRUFBUW1CLFFBQVFsQixFQUFLZ0IsVUFBVSxFQU8zQkcsRUFBcUIsQ0FDekIzRixjQUFlLHFCQUNmRSxhQUFjLGlCQUNkRSxvQkFBcUIseUJBQ3JCRSxnQkFBaUIsMEJBQ2pCRSxXQUFZLHdCQUdSb0YsRUFBb0IsSUFBSSxFQUM1QkQsRUFDQTlCLEdBR0lnQyxFQUFtQixJQUFJLEVBQzNCRixFQUNBN0IsR0FHRjhCLEVBQWtCeEQsbUJBQ2xCeUQsRUFBaUJ6RCxtQkEwQmpCZSxFQUFrQmxCLGlCQUFpQixTQUFTLEtBQzFDdUIsRUFBa0JzQyxNQUFReEMsRUFBYXJDLFlBQ3ZDd0MsRUFBd0JxQyxNQUFRdkMsRUFBbUJ0QyxZQUNuRCxFQUFVMEMsRUFBaUIsSUFFN0JHLEVBQW1CN0IsaUJBQWlCLFVBcEJwQyxTQUFpQ0MsR0FDL0JBLEVBQUVHLGlCQUNGLE1BQU1zQyxFQUFPWCxFQUFlOEIsTUFDdEJqQixFQUFPVixFQUFhMkIsTUFFeEJoQyxFQUFtQmpELGNBQWMsa0JBQ25Dd0QsRUFBVyxDQUFFTSxPQUFNRSxRQUFRZCxHQUMzQkMsRUFBZThCLE1BQVEsR0FDdkIzQixFQUFhMkIsTUFBUSxHQUNyQkQsRUFBaUIxRCxrQkFDakIsRUFBV2UsRUFDYixJQVVBRyxFQUFpQnBCLGlCQUFpQixTQUFTLElBQU0sRUFBVWlCLEtBQzNERSxFQUF3Qm5CLGlCQUFpQixTQUFTLElBQ2hELEVBQVdpQixLQVNiVSxFQUFpQjNCLGlCQUFpQixRQUFTbUMsR0FFM0NQLEVBQWdCNUIsaUJBQWlCLFVBeENqQyxTQUFpQ0MsR0FDL0JBLEVBQUVHLGlCQUNGaUIsRUFBYXJDLFlBQWN1QyxFQUFrQnNDLE1BQzdDdkMsRUFBbUJ0QyxZQUFjd0MsRUFBd0JxQyxNQUN6RDFCLEdBQ0YsSUFxQ0FWLEVBQXFCekIsaUJBQWlCLFNBQVMsSUFBTSxFQUFXLEtBckwzQyxDQUNuQixDQUNFMEMsS0FBTSxrQkFDTkUsS0FBTSxzR0FFUixDQUNFRixLQUFNLGNBQ05FLEtBQU0seUdBRVIsQ0FDRUYsS0FBTSxpQkFDTkUsS0FBTSw0R0FFUixDQUNFRixLQUFNLFVBQ05FLEtBQU0scUdBRVIsQ0FDRUYsS0FBTSx3QkFDTkUsS0FBTSxxR0FFUixDQUNFRixLQUFNLGlCQUNORSxLQUFNLG1HQWdLRzdDLFNBQVNzQyxHQUFhRCxFQUFXQyxFQUFVUCxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvVXRpbHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSBzZXR0aW5ncy5zdWJtaXRCdXR0b247XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxlbWVudHMpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b24pO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoXHJcbiAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMsXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbixcclxuICAgICAgdGhpcy5faW5wdXRTZWxlY3RvclxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKFxyXG4gICAgICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyxcclxuICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbixcclxuICAgICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3JcclxuICAgICAgICApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUVzY2FwZVVwKTtcclxuXHJcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBjbG9zZU1vZGFsT25SZW1vdGVDbGljayk7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVFc2NhcGVVcCk7XHJcblxyXG4gIG1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2spO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZVVwKGUpIHtcclxuICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWxPblJlbW90ZUNsaWNrKGV2dCkge1xyXG4gIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCkge1xyXG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcclxuICB9XHJcbn1cclxuIiwiY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbEZvb3RlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvb3RlclwiKTtcclxuY29uc3QgY2FyZEltYWdlRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG5cclxuaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH0gZnJvbSBcIi4vVXRpbHMuanNcIjtcclxuXHJcbmNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGNhcmREYXRhLCBjYXJkU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcblxyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUljb24oKSk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZVByZXZpZXdQaWN0dXJlKTtcclxuICB9XHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcbiAgX2hhbmRsZURlbGV0ZUNhcmQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZVByZXZpZXdQaWN0dXJlID0gKCkgPT4ge1xyXG4gICAgcHJldmlld0ltYWdlTW9kYWwuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHByZXZpZXdNb2RhbEZvb3Rlci50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICBwcmV2aWV3SW1hZ2VNb2RhbC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gIH07XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKS5hbHQgPSB0aGlzLl9hbHQ7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcclxuIiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4vRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi9DYXJkLmpzXCI7XHJcbmltcG9ydCB7IG9wZW5Nb2RhbCwgY2xvc2VNb2RhbCB9IGZyb20gXCIuL1V0aWxzLmpzXCI7XHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBhZGRDYXJkTW9kYWxDbG9zZUJ1dHRvbiA9XHJcbiAgYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZF9fY2xvc2UtbW9kYWxcIik7XHJcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZvcm0gRGF0YSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJldmlldyBNb2RhbCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld01vZGFsRm9vdGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9vdGVyXCIpO1xyXG5jb25zdCBtb2RhbFByZXZpZXdDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1jbG9zZS1idXR0b25cIik7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVsZW1lbnRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRDbG9zZSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtY2xvc2VcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1FbGVtZW50ID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcclxuXHJcbmNvbnN0IGNhcmRMaXN0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPVxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5cclxuY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9faW5wdXQtdHlwZS10aXRsZVwiXHJcbik7XHJcbmNvbnN0IGNhcmRVcmxJbnB1dCA9IGFkZENhcmRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbnB1dC10eXBlLXVybFwiKTtcclxuXHJcbmNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5mdW5jdGlvbiBjbG9zZVByb2ZpbGVNb2RhbCgpIHtcclxuICBjbG9zZU1vZGFsKHByb2ZpbGVFZGl0TW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcclxuICBjb25zdCBjYXJkSW1hZ2VFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgY2FyZFRpdGxlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIGNvbnN0IGxpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfSk7XHJcbiAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9KTtcclxuXHJcbiAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gICAgcHJldmlld0ltYWdlTW9kYWwuc3JjID0gY2FyZERhdGEubGluaztcclxuICAgIHByZXZpZXdNb2RhbEZvb3Rlci50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3SW1hZ2VNb2RhbC5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkVGl0bGVFbC5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gIGNhcmRJbWFnZUVsLnNyYyA9IGNhcmREYXRhLmxpbms7XHJcbiAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuY29uc3QgcmVuZGVyQ2FyZCA9IChjYXJkRGF0YSwgd3JhcHBlcikgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgY2FyZFNlbGVjdG9yKTtcclxuICB3cmFwcGVyLnByZXBlbmQoY2FyZC5nZXRWaWV3KCkpO1xyXG59O1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWxpZGF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybS1pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvbjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxyXG4gIHByb2ZpbGVFZGl0Rm9ybVxyXG4pO1xyXG5cclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcclxuICBhZGRDYXJkRm9ybUVsZW1lbnRcclxuKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFdmVudCBIYW5kbGVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChlKSB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudCA9IHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlO1xyXG4gIGNsb3NlUHJvZmlsZU1vZGFsKCk7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBuYW1lID0gY2FyZFRpdGxlSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgbGluayA9IGNhcmRVcmxJbnB1dC52YWx1ZTtcclxuICBjb25zdCBjYXJkRm9ybVN1Ym1pdEJ1dHRvbiA9XHJcbiAgICBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gIHJlbmRlckNhcmQoeyBuYW1lLCBsaW5rIH0sIGNhcmRMaXN0RWwpO1xyXG4gIGNhcmRUaXRsZUlucHV0LnZhbHVlID0gXCJcIjtcclxuICBjYXJkVXJsSW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY2xvc2VNb2RhbChhZGRDYXJkTW9kYWwpO1xyXG59XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50IExpc3RlbmVyICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBwcm9maWxlVGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgb3Blbk1vZGFsKHByb2ZpbGVFZGl0TW9kYWwpO1xyXG59KTtcclxuYWRkQ2FyZEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQpO1xyXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwoYWRkQ2FyZE1vZGFsKSk7XHJcbmFkZENhcmRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gIGNsb3NlTW9kYWwoYWRkQ2FyZE1vZGFsKVxyXG4pO1xyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2soZXZ0KSB7XHJcbiAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICBjbG9zZU1vZGFsKGV2dC50YXJnZXQpO1xyXG4gIH1cclxufVxyXG5cclxucHJvZmlsZUVkaXRDbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VQcm9maWxlTW9kYWwpO1xyXG5cclxucHJvZmlsZUVkaXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQpO1xyXG5cclxubW9kYWxQcmV2aWV3Q2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwocHJldmlld01vZGFsKSk7XHJcblxyXG5pbml0aWFsQ2FyZHMuZm9yRWFjaCgoY2FyZERhdGEpID0+IHJlbmRlckNhcmQoY2FyZERhdGEsIGNhcmRMaXN0RWwpKTtcclxuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfc2V0dGluZ3MiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwic3VibWl0QnV0dG9uIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxlbWVudHMiLCJkaXNhYmxlZCIsImlucHV0TGlzdCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zZXRFdmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJtb2RhbCIsImRvY3VtZW50IiwiaGFuZGxlRXNjYXBlVXAiLCJjbG9zZU1vZGFsT25SZW1vdGVDbGljayIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJldnQiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwicHJldmlld01vZGFsIiwicHJldmlld0ltYWdlTW9kYWwiLCJwcmV2aWV3TW9kYWxGb290ZXIiLCJhZGRDYXJkTW9kYWwiLCJwcm9maWxlRWRpdEJ1dHRvbiIsImFkZENhcmRNb2RhbENsb3NlQnV0dG9uIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJtb2RhbFByZXZpZXdDbG9zZUJ0biIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlRWRpdENsb3NlIiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwiY2FyZExpc3RFbCIsImNhcmRUaXRsZUlucHV0IiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2FyZFVybElucHV0IiwiY2xvc2VQcm9maWxlTW9kYWwiLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJ3cmFwcGVyIiwiY2FyZCIsImNhcmRTZWxlY3RvciIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfZ2V0VGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJfZWxlbWVudCIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2hhbmRsZVByZXZpZXdQaWN0dXJlIiwidG9nZ2xlIiwic3JjIiwiYWx0IiwiZ2V0VmlldyIsIl9hbHQiLCJwcmVwZW5kIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwidmFsdWUiXSwic291cmNlUm9vdCI6IiJ9